<!DOCTYPE html>
<!- Desenvolvido por Paulo R. S. Pissinini Neto->
<html lang="pt-br">
<head>
    <title>Apoio N1 e N2 - TRT9</title>
    <meta charset="utf-8">
    <link rel="icon" type="image/png" href="../Imagens/favicon.png">
    <link rel="shortcut icon" href="../Imagens/favicon.png" type="image/png">
    <link rel="stylesheet" href="../css/index.css">
    <link rel="stylesheet" href="../css/styles.css">
    <script src="../js/script_index.js"></script>
    <script src="../js/scroll.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.1/font/bootstrap-icons.min.css">
</head>
<body onload="javascript:lerMais1a(); javascript:lerMais2a(); javascript:lerMais3a(); javascript:lerMais4a(); javascript:lerMais5a();">

    <script src="../js/redimensoes_footer_header.js"></script>
    <script src="../js/header.js"></script>

    <style>
        .redtext {
            color: BLACK;
        }
    </style>

    <script type="text/javascript">

        document.addEventListener('DOMContentLoaded', function () {
            var button = document.getElementById('BotaoVoltar');
            button.classList.add('hidden'); // Garantir que o bot√£o comece oculto ao carregar a p√°gina
        });

        document.addEventListener('scroll', function () {
            var button = document.getElementById('BotaoVoltar');
            var triggerHeight = 250; // Altura em pixels na qual o bot√£o deve aparecer

            if (window.scrollY >= triggerHeight) {
                button.classList.remove('hidden');
            } else {
                button.classList.add('hidden');
            }
        });
    </script>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const botao = document.getElementById('exportarLista');

  if (botao) {
    botao.scrollIntoView({
      behavior: 'smooth',
      block: 'nearest'
    });
  }
});
</script>


    <article id="article-b">
        <br><br>

        <div class="voltar">
            <button id="BotaoVoltar" alt="Voltar ao Topo" title="Voltar ao Topo" onclick="scrollToTop()">
             <i class="fa-solid fa-arrow-up"></i>
            </button>
        </div>

        <article id="article-f">
            <div style='background-color:#FFF5EE;  border-radius: 10px;'>
                <div id="div3">
                    <h2> <font size="4" style="font-family: Courier New, monospace; color: #ef314c;"> AVISOS!</font></h2><br>
                    <ul class="painel-de-avisos" style="padding-left: 10px;">
                        <li class="aviso" data-data="2024-07-27">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">COMUNICADO:</span>
                                     "Manuten√ß√£o Programada do Sistema PJe".
                                      Tarefa:
                               <span class="aviso-tarefa">R237441</span>.
                                      Data:
                               <span class="aviso-data">27/07/2024</span>.
                            </p>
                        </li><br>
                        <li class="aviso" data-data="2024-04-26">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">ORIENTA√á√ÉO:</span>
                                     "Em conformidade com a <a id="a_avisos" href="https://atos.cnj.jus.br/files/original12133120240426662b9a6b7400a.pdf" target="_blank">
                                        Portaria CNJ 140/2024</a>, <b style="font-family: Arial">Art. 1¬∫, par√°grafo 2¬∫</b>, informa-se que <b style="font-family: Arial">
                                            a habilita√ß√£o do MFA √© mandat√≥ria</b>, n√£o cabendo aos usu√°rios optarem por sua utiliza√ß√£o".
                                      Data:
                               <span class="aviso-data">26/04/2024</span>.
                            </p>
                        </li><br>
                        <li class="aviso" data-data="2024-08-20">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">ORIENTA√á√ÉO:</span>
                                     "N√£o est√° sendo localizado na Intranet o menu de <b style="font-family: Arial">Cadastro de Prazo do Certificado do e-Token</b>. 
                                      Fun√ß√£o pode ser acessada diretamente no seguinte <a id="a_avisos" href="https://intranet.trt9.jus.br/intranet2/f?p=10182:3:213499140943259:::::" target="_blank">LINK</a>".
                                      Data:
                               <span class="aviso-data">20/08/2024</span>.
                            </p>
                        </li><br>
                        <li class="aviso" data-data="2024-10-01">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">ORIENTA√á√ÉO:</span>
                                     "Informe-se sobre a reativa√ß√£o do <b style="font-family: Arial">Ponto Eletr√¥nico</b>:
                                    <a id="a_avisos" href="https://intranet.trt9.jus.br/intranet2/f?p=192:113:311213937673980:::::" target="_blank">Perguntas Frequentes</a>".
                                      Data:
                               <span class="aviso-data">10/01/2024</span>.
                            </p>
                        </li><br>
                        <li class="aviso" data-data="2024-12-02">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">ORIENTA√á√ÉO:</span>
                                     "Informe-se sobre o <b style="font-family: Arial">
                                    <a id="a_avisos" href="https://www.trt9.jus.br/cswiki/index.php?curid=11186" target="_blank">Novo Padr√£o de Senhas</a></b>.
                                    <a id="a_avisos" href="https://www.trt9.jus.br/basesjuridicas/resolucaoadministrativa.xhtml?id=2447300" target="_blank">Resolu√ß√£o Administrativa</a>".
                                      Data:
                               <span class="aviso-data">02/12/2024</span>.
                            </p>
                        </li><br>
                        <li class="aviso" data-data="2025-04-02">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">ORIENTA√á√ÉO:</span>
                                     "Informe-se sobre o procedimento em fluxo para <b style="font-family: Arial">Atualiza√ß√£o de Email no PDPJ</b>".
                                      Data:
                               <span class="aviso-data">02/04/2025</span>.
                            </p>                              <button id="botao_ver_imagem" onclick="toggleImagem()">Ver Imagem</button>
                                <div class="imagem-container" id="imagemContainer">
                                    <img src="../Imagens/diagramapdpj.png" alt="Diagrama PDPJ">
                                </div>
                        </li>
                        <br>
                        <li class="aviso" data-data="2025-12-04">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">FALHA GERAL:</span>
                                     "F√≥rum de Marechal C√¢ndido Rondon sem Comunica√ß√£o".
                                      Tarefa:
                               <span class="aviso-tarefa">542274</span>.
                                      Data:
                               <span class="aviso-data">04/12/2025</span>.
                            </p>
                        </li><br>
                        <li class="aviso" data-data="2025-12-05">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">ORIENTA√á√ÉO:</span>
                                     "Erro ao realizar solicita√ß√£o de esclarecimentos - Ser√° solucionado somente com a vers√£o 2.18.3 do PJe".
                                      Tarefa:
                               <span class="aviso-tarefa">542366</span>.
                                      Data:
                               <span class="aviso-data">05/12/2025</span>.
                            </p>
                        </li><br>
                        <li class="aviso" data-data="2025-12-09">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">FALHA GERAL:</span>
                                     "Problemas para se logar na VPN - Ocorre somente em equipamentos dentro do dom√≠nio do TRT9".
                                      Tarefa:
                               <span class="aviso-tarefa">542801</span>.
                                      Data:
                               <span class="aviso-data">09/12/2025</span>.
                            </p>
                        </li><br>
                        <li class="aviso" data-data="2025-11-17">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">FALHA GERAL:</span>
                                     "Erro ao Solicitar Habilita√ß√£o no PJe".
                                      Tarefa:
                               <span class="aviso-tarefa">541237</span>.
                                      Data:
                               <span class="aviso-data">17/11/2025</span>.
                            </p>
                        </li><br>
                        <li class="aviso" data-data="2025-11-18">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">FALHA GERAL:</span>
                                     "Erro ao Designar Per√≠cias no PJe".
                                      Tarefa:
                               <span class="aviso-tarefa">541276</span>.
                                      Data:
                               <span class="aviso-data">18/11/2025</span>.
                            </p>
                        </li><br>
                        <li class="aviso" data-data="2025-12-16">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">FALHA GERAL:</span>
                                     "Problemas para Recebimento de Emails (2FA)".
                                      Tarefa:
                               <span class="aviso-tarefa">542951</span>.
                                      Data:
                               <span class="aviso-data">16/12/2025</span>.
                            </p>
                        </li><br>
                        <li class="aviso" data-data="2025-12-16">
                            <p class="aviso-texto">
                               <span class="aviso-titulo">FALHA GERAL:</span>
                                     "Problemas com a Suspens√£o e Encerramento de Tarefas no Assyst".
                                      Tarefa:
                               <span class="aviso-tarefa">543091</span>.
                                      Data:
                               <span class="aviso-data">16/12/2025</span>.
                            </p>
                        </li><br>
                    </ul>

                </div>

        <button id="exportarLista"onclick="exportarCSV()"><i class="bi bi-file-earmark-excel"></i> Exportar</button>

<script>
function exportarCSV() {
  const avisos = document.querySelectorAll('.aviso');

  // BOM UTF-8 para Excel PT-BR
  let csv = '\uFEFFMotivo;Descricao;Tarefa;Data\n';

  avisos.forEach(aviso => {

    // Motivo
    const motivoEl = aviso.querySelector('.aviso-titulo');
    const motivo = motivoEl
      ? motivoEl.innerText.replace(':', '').trim()
      : '';

    // Tarefa (campo pr√≥prio)
    const tarefa = aviso.querySelector('.aviso-tarefa')?.innerText || '';

    // Data t√©cnica (YYYY-MM-DD)
    const data = aviso.dataset.data || '';

    // Texto completo
    let descricao = aviso.querySelector('.aviso-texto')?.innerText || '';

    // üîπ Remove o motivo do in√≠cio
    if (motivo) {
      const regexMotivo = new RegExp(`^${motivo}:?\\s*`, 'i');
      descricao = descricao.replace(regexMotivo, '');
    }

    // üîπ Remove "Tarefa: 542951" (novo padr√£o)
    descricao = descricao.replace(
      /Tarefa:\s*[A-Z0-9-]+\s*\.?\s*/gi,
      ''
    );

    // üîπ Remove "Data: DD/MM/YYYY"
    descricao = descricao.replace(
      /Data:\s*\d{2}\/\d{2}\/\d{4}\s*\.?\s*/gi,
      ''
    );

    // üîπ Limpeza final
    descricao = descricao
      .replace(/\s{2,}/g, ' ')
      .replace(/^[‚Äú"]+|[‚Äù"]+$/g, '')
      .replace(/\.$/, '')
      .replace(/["'‚Äú‚Äù‚Äò‚Äô]\s*\./g, '.')
      .trim();

    csv += `"${motivo}";"${descricao}";"${tarefa}";"${data}"\n`;
  });

  const blob = new Blob([csv], {
    type: 'text/csv;charset=utf-8;'
  });

  const url = URL.createObjectURL(blob);

  const link = document.createElement('a');
  link.href = url;
  link.download = 'lista_avisos.csv';
  link.click();

  URL.revokeObjectURL(url);
}
</script>



    <!-- Estilo do Bot√£o Exportar -->
    <style>
        #exportarLista {
            margin-top: 35px;
            margin-right: 0px;
            margin-bottom: 5px;
            padding: 8px 14px;
            border-radius: 8px;
            border: none;
            background-color: #333;
            color: white;
            font-size: 14px;
            cursor: pointer;
            opacity: 0.85;
            float: right;
        }
        #exportarLista:hover {
            opacity: 1;
        }
    </style>

            </div>


            <script>
    function toggleImagem() {
        var imagemContainer = document.getElementById("imagemContainer");
        if (imagemContainer.style.display === "none" || imagemContainer.style.display === "") {
            imagemContainer.style.display = "block";
        } else {
            imagemContainer.style.display = "none";
        }
    }
</script>

    <style>
        .redtext {
            color: BLACK;
        }

        .imagem-container {
            display: none;
            margin-top: 10px;
            border-left: 2px solid #ccc;
            padding-left: 10px;
        }

        .imagem-container img {
            max-width: 100%;
            height: auto;
        }

        #botao_ver_imagem {
            background-color: rgb(37, 37, 39);
            border: 1px solid #e7e7e7;
            border-radius: 8px;
            color: white;
            padding: 4px 12px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            margin: 4px 2px;
            cursor: pointer;
        }

        #botao_ver_imagem:hover {
            background-color: #104E8B;
            color: white;
        }
    </style>

    <div style="padding-top: 200px;">

    </div>

        </article>
        <br><br><br><br>
    </article>
    <script src="../js/footer.js"></script>
</body>
</html>
